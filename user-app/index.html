<!DOCTYPE html>
<html lang="en" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>User App</title>

<!-- Your existing CSS & libraries -->
<link rel="stylesheet" href="assets/index.css" />
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/js-sha256/dist/sha256.min.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
/* --- Styles for inline welcome container --- */
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background-color: #f9f9f9;
}
/* Welcome inline container styles */
#welcomeInline {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
#welcomeContent {
  max-width: 350px;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0,0,0,0.2);
  background: #fff;
  text-align: center;
}
#welcomeContent img {
  width: 250px;
  height: auto;
  margin-bottom: 20px;
}
</style>
</head>
<body>

<!-- Inline Welcome Page -->
<div id="welcomeInline">
  <div id="welcomeContent">
    <img src="img/screenshot (250).jpg" alt="Welcome Image" />
    <h2 style="color:gray;">Welcome</h2>
    <p>Before enjoying CrunchTime deliveries</p>
    <p>Register now</p>
    <button id="createAccountBtn" style="background-color:red; color:white; padding:10px; border:none; border-radius:5px; cursor:pointer; width:80%; margin-top:10px;">Create account</button>
    <button id="loginBtn" style="background-color:white; color:red; padding:10px; border:2px solid red; border-radius:5px; cursor:pointer; width:80%; margin-top:10px;">Login</button>
    <button id="browserMenuBtn" style="background-color:red; color:white; padding:10px; border:none; border-radius:5px; cursor:pointer; width:80%; margin-top:10px;">Browser Menu</button>
    <p style="margin-top:20px; font-size:12px; color:gray;">By logging in or registering, you have agreed to the Terms and Conditions and Privacy Policy.</p>
  </div>
</div>

<!-- Main Content (hidden initially) -->
<div id="mainContent" style="display:none;">
  <!-- Your existing header, filters, restaurant list, modals, scripts, etc. -->
  <!-- Example Header -->
  <div class="header" style="display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#fff; border-bottom:1px solid #ddd;">
    <div class="header">
      <div class="driver-label" style="font-weight:bold; color:red; font-size:20px;">User</div>
    </div>
    <div class="menu-container" style="position:relative;">
      <button class="menu-button" id="menuButton" style="background-color:red; color:#fff; padding:8px 12px; border:none; border-radius:4px; cursor:pointer; font-weight:bold;">Menu ▼</button>
      <div class="dropdown-content" id="dropdownContent" style="display:none; position:absolute; right:0; top:100%; background:#fff; min-width:200px; box-shadow:0 2px 8px rgba(0,0,0,0.2); border-radius:4px; overflow:hidden; z-index:1000;">
        <a href="#" id="orderViewLink" style="display:block; padding:10px 15px; text-decoration:none; color:#333;">Order View</a>
        <a href="#" id="newDriverLink" style="display:block; padding:10px 15px; text-decoration:none; color:#333;">New Driver</a>
        <a href="#" id="driverAccountLink" style="display:block; padding:10px 15px; text-decoration:none; color:#333;">User View Account</a>
        <a href="#" id="logoutLink" style="display:block; padding:10px 15px; text-decoration:none; color:#333;">Logout</a>
      </div>
    </div>
  </div>

  <!-- OTP Modal -->
  <div id="otpModal" class="modal" style="display:none;">
    <div class="modal-content" style="max-width:400px;">
      <h3>Verify Account</h3>
      <p>Please enter the OTP number sent to your email to reset your password</p>
      <p>Enter your OTP code here</p>
      <input type="text" id="otpInput" maxlength="4" placeholder="Enter OTP" style="width:100%; padding:8px;"/>
      <div style="margin-top:10px;">
        <p>Didn’t receive code? <button id="resendOtpBtn">Request again</button></p>
      </div>
      <div style="margin-top:10px;">
        <button id="verifyOtpBtn" style="background:#007bff; color:#fff; padding:8px 16px; border:none; border-radius:4px;">Confirm</button>
      </div>
    </div>
  </div>

  <!-- Login Modal -->
  <div id="loginModal" class="modal" style="display:none;">
    <div class="modal-content" style="max-width:400px;">
      <h2>Welcome</h2>
      <h3>Login</h3>
      <p>Welcome to CrunchTime halaal food delivery. Login to start ordering.</p>
      <label>Email Address</label>
      <input type="text" id="loginEmail" placeholder="Email" style="width:100%; padding:8px; margin-top:10px; border:1px solid #ccc; border-radius:4px;"/>
      <label>Password</label>
      <input type="password" id="loginPassword" placeholder="Password" style="width:100%; padding:8px; margin-top:10px; border:1px solid #ccc; border-radius:4px;"/>
      <button style="margin-top:20px; background-color:red; color:#fff; padding:10px; border:none; border-radius:5px; cursor:pointer; width:100%;" onclick="submitLogin()">Login</button>
    </div>
  </div>

  <!-- Your existing modals for menu, food, order summary, checkout, order history, voucher, pin, driver map -->
  <!-- Keep your existing code here as in your original post -->
</div>

<script>
// Your existing scripts, with minor adjustments for the welcome flow
let registeredEmail='';
let registeredPassword='';
let userPIN='';

// Utility functions
function showElement(id){ document.getElementById(id).style.display='block'; }
function hideElement(id){ document.getElementById(id).style.display='none'; }

// Toggle dropdown menu
const menuButton = document.getElementById('menuButton');
const menuContainer = document.getElementById('menuContainer');
if (menuButton) {
  menuButton.addEventListener('click', ()=> {
    const dropdown = document.getElementById('dropdownContent');
    dropdown.style.display = (dropdown.style.display==='block')?'none':'block';
  });
}
window.onclick = function(e) {
  if (!e.target.closest('#menuContainer')) {
    document.getElementById('dropdownContent').style.display='none';
  }
}

// When page loads
window.onload = function() {
  // Show welcome inline first
  document.getElementById('welcomeInline').style.display='flex';
  document.getElementById('mainContent').style.display='none';

  // When user clicks continue
  document.getElementById('continueBtn').onclick = () => {
    document.getElementById('welcomeInline').style.display='none';
    showMainContent();
  };
};

// Show main content
function showMainContent() {
  document.getElementById('welcomeInline').style.display='none';
  document.getElementById('mainContent').style.display='block';
  initializeApp(); // your existing init
}

// Login modal functions
function showLoginModal() {
  document.getElementById('loginEmail').value='';
  document.getElementById('loginPassword').value='';
  showElement('loginModal');
}
function closeLoginModal() {
  hideElement('loginModal');
}
function submitLogin() {
  const email = document.getElementById('loginEmail').value.trim().toLowerCase();
  const password = document.getElementById('loginPassword').value.trim();

  // For demo: Accept any email/password, or implement your validation
  if (email && password) {
    registeredEmail = email;
    registeredPassword = password;
    alert('Login successful!');
    closeLoginModal();
    showMainContent();
  } else {
    alert('Please enter email and password.');
  }
}
</script>
</body>
</html>