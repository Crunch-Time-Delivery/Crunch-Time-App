<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Home Dashboard</title>
<style>
    /* General styles */
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f9f9f9;
    }

    /* Header styles */
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 20px;
        background-color: #fff;
        border-bottom: 1px solid #ddd;
    }
    .header button {
        background: none;
        border: none;
        font-size: 16px;
        cursor: pointer;
        padding: 5px 10px;
    }
    .header .search-bar {
        flex-grow: 1;
        margin: 0 10px;
    }
    .header .search-bar input {
        width: 100%;
        padding: 5px;
        border: 1px solid #ddd;
        border-radius: 5px;
    }

    /* Filters styles */
    .filters {
        display: flex;
        justify-content: space-between;
        padding: 10px 20px;
        background-color: #ffb4b4;
        border-bottom: 1px solid #ddd;
        flex-wrap: wrap;
    }
    .filters button {
        background: none;
        border: none;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 5px;
    }
    .filters button img {
        width: 24px;
        height: 24px;
        margin-bottom: 5px;
    }

    /* Restaurant list styles */
    .restaurant-list {
        padding: 10px 20px;
        max-height: 70vh;
        overflow-y: auto;
    }
    .restaurant-card {
        display: flex;
        background-color: #fff;
        margin-bottom: 10px;
        padding: 10px;
        border-radius: 5px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        cursor: pointer;
        align-items: center;
        position: relative;
        transition: background 0.2s;
    }
    /* Image style for restaurant cards */
    .restaurant-card img {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 5px;
        margin-right: 10px;
    }
    .restaurant-card .details {
        flex-grow: 1;
    }
    .restaurant-card .rating {
        color: #666;
    }
    .restaurant-card .promo {
        color: red;
        font-weight: bold;
    }
    /* Heart button style */
    .restaurant-card button.heart {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 20px;
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: transparent;
    }

    /* Modal styles */
    .modal {
        display: none; 
        position: fixed;
        z-index: 999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.6);
        justify-content: center;
        align-items: center;
    }
    .modal-content {
        background-color: #fff;
        margin: 50px auto;
        padding: 20px;
        border-radius: 10px;
        max-width: 600px;
        width: 90%;
        animation: popin 0.3s ease;
        position: relative;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    @keyframes popin {
        from {transform: scale(0.9); opacity: 0;}
        to {transform: scale(1); opacity: 1;}
    }
    .close-btn {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
    }
    /* Style for images in modal with fixed size and object-fit */
    #restaurantImage {
        width: 100%;
        max-height: 200px;
        object-fit: cover;
        border-radius: 5px;
        margin-bottom: 10px;
    }
    /* Menu item styles */
    .menu-item {
        margin-bottom: 10px;
        cursor: pointer;
        padding: 8px;
        border: 1px solid #eee;
        border-radius: 4px;
        transition: background 0.2s;
    }
    .menu-item:hover {
        background-color: #f0f0f0;
    }
    .view-map-btn {
        display: inline-block;
        margin-top: 20px;
        padding: 10px 15px;
        background-color: #ff0000;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        text-decoration: none;
        font-weight: bold;
    }

    /* Food modal styles */
    .food-modal {
        display: none;
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.5);
        justify-content: center;
        align-items: center;
    }
    .food-modal-content {
        background-color: #fff;
        margin: 50px auto;
        padding: 20px;
        border-radius: 10px;
        max-width: 400px;
        width: 90%;
        animation: popin 0.3s ease;
        position: relative;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    .food-close-btn {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
    }
    /* Quantity controls */
    .quantity-controls {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    .quantity-btn {
        padding: 2px 8px;
        font-size: 18px;
        cursor: pointer;
        background-color: #ddd;
        border: none;
        border-radius: 4px;
    }
    /* Buttons style */
    .add-more-btn {
        margin-top: 20px;
        padding: 10px 15px;
        background-color: #f40404;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-right: 10px;
    }
    .exit-btn {
        margin-top: 20px;
        padding: 10px 15px;
        background-color: #f40505;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    /* Checkout page styles */
    #checkoutPage {
        display: none;
        padding: 20px;
        background: #fff;
        max-width: 700px;
        margin: auto;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        margin-top: 20px;
    }
    #checkoutPage h2 {
        margin-top: 0;
        text-align: center;
        color: #333;
        font-size: 24px;
        margin-bottom: 10px;
    }
    #checkoutPage h3 {
        margin-top: 20px;
        margin-bottom: 10px;
        color: #555;
        font-size: 20px;
    }
    #checkoutItems {
        list-style: none;
        padding: 0;
        margin: 10px 0;
        max-height: 150px;
        overflow-y: auto;
    }
    #checkoutItems li {
        margin-bottom: 8px;
        padding: 6px;
        background: #f7f7f7;
        border-radius: 4px;
    }
    /* Breakdown styling */
    #costBreakdown p, #costBreakdown h3 {
        margin: 5px 0;
        font-weight: normal;
    }
    #costBreakdown h3 {
        font-weight: bold;
        font-size: 20px;
        margin-top: 10px;
    }
    /* Buttons */
    #checkoutBtn {
        display: block;
        width: 100%;
        padding: 15px;
        background-color: #ff0000;
        color: white;
        font-size: 16px;
        font-weight: bold;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 20px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        transition: background 0.3s;
    }
    #checkoutBtn:hover {
        background-color: #fb0404;
    }
    /* Voucher section styling */
    #voucherSection {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 20px;
    }
    #voucherButton {
        padding: 10px 20px;
        background-color: #cc0000;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        color: #fff;
        cursor: pointer;
        transition: background 0.2s;
        margin-bottom: 10px;
    }
    #voucherButton:hover {
        background-color: #b50000;
    }

    /* Voucher modal styles */
    #voucherModal {
        display: none;
        position: fixed;
        z-index: 9999;
        left: 0; top: 0;
        width: 100%; height: 100%;
        background-color: rgba(0,0,0,0.6);
        justify-content: center;
        align-items: center;
    }
    #voucherContent {
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 400px;
        animation: popin 0.3s ease;
        text-align: center;
        position: relative;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    #closeVoucher {
        position: absolute;
        top: 10px; right: 15px;
        font-size: 24px; font-weight: bold; cursor: pointer;
    }
    #voucherInput {
        width: 100%;
        padding: 8px;
        font-size: 16px;
        margin-top: 20px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    #applyVoucher {
        margin-top: 15px;
        padding: 10px 20px;
        background-color: #f40505;
        border: none;
        border-radius: 5px;
        color: #fff;
        font-size: 16px;
        cursor: pointer;
        transition: background 0.2s;
    }
    #applyVoucher:hover {
        background-color: #f30404;
    }
    /* QR code placeholder */
    #qrCodeContainer {
        margin-top: 20px;
    }
    #qrCodePlaceholder {
        width: 150px;
        height: 150px;
        background: #eee;
        display: inline-block;
        line-height: 150px;
        color: #999;
        font-size: 14px;
        border-radius: 10px;
    }
</style>
</head>
<body>

<div class="header">
    <button>☰</button>
    <div>Crunch Time</div>
    <button>Delivery</button>
    <button>Pickup</button>
    <div class="search-bar">
        <input type="text" placeholder="Search Crunch Time ">
    </div>
    <button>Map Location - Pick up now</button>
</div>

<div class="filters">
    <button><img src="Images/Ultraprocessed foods display 2 framed - shutterstock_2137640529_r.jpg" alt="Fast Food"><span>Fast Food</span></button>
    <button><img src="Images/CR7 Veg .jpg" alt="Healthy"><span>Healthy</span></button>
    <button><img src="Images/CR7.jpg" alt="Burgers"><span>Burgers</span></button>
    <button><img src="Images/CR7 SUCCI.jpg" alt="Chinese"><span>Chinese</span></button>
    <button><img src="Images/CR7 WINGS.jpg" alt="Wings"><span>Wings</span></button>
    <button><img src="Images/CR7 PIZZA.webp" alt="Pizza"><span>Pizza</span></button>
    <button><img src="Images/CR7 SUCCI.webp" alt="Halal"><span>Halal</span></button>
    <button><img src="Images/CR7 KOREA.jpeg" alt="Korean"><span>Korean</span></button>
    <button>→</button>
</div>

<div class="restaurant-list">
    <div class="restaurant-card" onclick="showMenu('KFC Parow')">
        <img src="Images/RS KFC.jpeg" alt="KFC Parow" />
        <div class="details">
            <div>KFC, Parow</div>
            <div class="rating">4.4 ★</div>
            <div>Sponsored - 5 min - 4.4 km</div>
        </div>
        <button class="heart" onclick="event.stopPropagation(); toggleFavorite(this)">♥</button>
    </div>
    <div class="restaurant-card" onclick="showMenu('Sannes Palace')">
        <img src="Images/RS PALACE.jpg" alt="Sannes Palace" />
        <div class="details">
            <div>Sannes Palace</div>
            <div class="rating">4.5 ★</div>
            <div class="promo">Spend ZAR 100, Save ZAR 15</div>
            <div>20 min - 0.5 km</div>
        </div>
        <button class="heart" onclick="event.stopPropagation(); toggleFavorite(this)">♥</button>
    </div>
    <div class="restaurant-card" onclick="showMenu('DK Spot & Kota')">
        <img src="Images/RS KOTA.jpg" alt="DK Spot & Kota" />
        <div class="details">
            <div>DK Spot & Kota Restaurant</div>
            <div class="rating">4.0 ★</div>
            <div>Uber Eats HDP-Owned - 16 min - 0.6 km</div>
        </div>
        <button class="heart" onclick="event.stopPropagation(); toggleFavorite(this)">♥</button>
    </div>
    <div class="restaurant-card" onclick="showMenu('Nondyebo Eatery')">
        <img src="Images/RS NONDYEBO.jpg" alt="Nondyebo Eatery" />
        <div class="details">
            <div>Nondyebo Eatery</div>
            <div class="rating">3.3 ★</div>
            <div>10 min - 0.6 km</div>
        </div>
        <button class="heart" onclick="event.stopPropagation(); toggleFavorite(this)">♥</button>
    </div>
</div>

<!-- Modal for Menu -->
<div id="menuModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <img id="restaurantImage" src="" alt="Restaurant Image" class="modal-img" />
        <h2 id="restaurantName">Restaurant Menu</h2>
        <div id="menuItems"></div>
        <button class="view-map-btn" onclick="viewMap()">View Map Location</button>
    </div>
</div>

<!-- Food modal for adding items -->
<div id="foodModal" class="food-modal">
    <div class="food-modal-content">
        <span class="food-close-btn" onclick="closeFoodModal()">&times;</span>
        <h3 id="foodItemName">Food Item</h3>
        <div style="display:flex; align-items:center; justify-content:space-around; margin-top:10px;">
            <button class="quantity-btn" onclick="changeQuantity(-1)">-</button>
            <span id="foodQuantity">1</span>
            <button class="quantity-btn" onclick="changeQuantity(1)">+</button>
        </div>
        <div style="margin-top:20px; display:flex; justify-content:center;">
            <button class="add-more-btn" onclick="addItemToOrder()">Add More Items</button>
            <button class="exit-btn" onclick="closeFoodModal()">Exit</button>
        </div>
    </div>
</div>

<!-- Order summary with checkout and voucher -->
<div id="orderSummary" style="padding:10px 20px; background:#fff; max-height:200px; overflow-y:auto; margin:10px;">
    <h4>Order Summary</h4>
    <ul id="orderItems"></ul>
    <button id="checkoutBtn" class="checkout-btn" onclick="goToCheckout()">Go to Checkout</button>
    <div id="voucherSection">
        <button id="voucherButton" onclick="openVoucherModal()">Enter Voucher / Coupon</button>
    </div>
</div>

<!-- Checkout page (hidden initially) -->
<div id="checkoutPage">
    <h2 id="checkoutRestaurantTitle">Checkout</h2>
    <h3>Order Breakdown</h3>
    <ul id="checkoutItems"></ul>
    <div id="costBreakdown" style="margin-top:10px;">
        <p>Subtotal: <span id="subtotalDisplay">R0.00</span></p>
        <p>VAT (15%): <span id="vatDisplay">R0.00</span></p>
        <p>Service Fee: <span id="serviceFeeDisplay">R5.00</span></p>
        <p>Tip: <span id="tipDisplay">R3.00</span></p>
        <p>Delivery Fee: <span id="deliveryFeeDisplay">R10.00</span></p>
        <h3>Total (Tax Incl.): <span id="totalAmount">R0.00</span></h3>
        <p style="margin-top:10px; font-weight:bold;">Discount Applied: <span id="discountAmount">R0.00</span></p>
    </div>
    <h3>Payment Method</h3>
    <div style="margin-bottom:20px;">
        <input type="radio" id="eft" name="payment" value="EFT" checked>
        <label for="eft">EFT Bank Transfer</label>
    </div>
    <button class="pay-btn confirm-btn" onclick="confirmEFT()">Confirm EFT Payment</button>
    <button class="pay-btn cancel-btn" onclick="cancelCheckout()">Cancel</button>
</div>

<!-- Voucher modal -->
<div id="voucherModal" style="display:none; justify-content:center; align-items:center;">
    <div id="voucherContent">
        <span id="closeVoucher" onclick="closeVoucherModal()">&times;</span>
        <h3>Enter Voucher Code</h3>
        <input type="text" id="voucherInput" placeholder="Enter your coupon code" />
        <button id="applyVoucher" onclick="applyVoucher()">Apply Coupon</button>
        <div id="qrCodeContainer">
            <p>Or scan QR code:</p>
            <div id="qrCodePlaceholder">[QR CODE IMAGE]</div>
        </div>
    </div>
</div>

<script>
    // Placeholder menu data
    const restaurantMenus = {
        "KFC Parow": [
            { name: "Zinger Burger", price: "R50" },
            { name: "Fries", price: "R20" },
            { name: "Cola", price: "R15" }
        ],
        "Sannes Palace": [
            { name: "Chicken Curry", price: "R80" },
            { name: "Veggie Plate", price: "R60" },
            { name: "Lemonade", price: "R10" }
        ],
        "DK Spot & Kota": [
            { name: "Kota Special", price: "R25" },
            { name: "Fries", price: "R20" },
            { name: "Soda", price: "R15" }
        ],
        "Nondyebo Eatery": [
            { name: "Wrap", price: "R40" },
            { name: "Salad", price: "R35" },
            { name: "Juice", price: "R12" }
        ]
    };

    let currentRestaurant = '';
    let selectedFoodItem = null;
    let currentQuantity = 1;
    let orderItems = [];

    // Fees
    const SERVICE_FEE = 5.00;
    const TIP = 3.00;
    const DELIVERY_FEE = 10.00;

    // Voucher
    let appliedVoucher = null;
    let discountAmount = 0;

    function showMenu(restaurantName) {
        currentRestaurant = restaurantName;
        document.getElementById('restaurantName').innerText = restaurantName + ' Menu';

        const imageElement = document.getElementById('restaurantImage');
        switch (restaurantName) {
            case 'KFC Parow': imageElement.src = 'Images/RS KFC.jpeg'; break;
            case 'Sannes Palace': imageElement.src='Images/RS PALACE.jpg'; break;
            case 'DK Spot & Kota': imageElement.src='Images/RS KOTA.jpg'; break;
            case 'Nondyebo Eatery': imageElement.src='Images/RS NONDYEBO.jpg'; break;
            default: imageElement.src=''; break;
        }

        const menuDiv = document.getElementById('menuItems');
        menuDiv.innerHTML = '';
        const menuList = restaurantMenus[restaurantName] || [];
        menuList.forEach(item => {
            const div = document.createElement('div');
            div.className='menu-item';
            div.innerHTML=`<strong>${item.name}</strong> - ${item.price}`;
            div.onclick=()=>{ openFoodModal(item); };
            menuDiv.appendChild(div);
        });
        document.getElementById('menuModal').style.display='block';
    }

    function closeModal() { document.getElementById('menuModal').style.display='none'; }
    function viewMap() {
        let url='';
        switch (currentRestaurant) {
            case 'KFC Parow': url='https://www.google.com/maps/search/?api=1&query=KFC+Parow'; break;
            case 'Sannes Palace': url='https://www.google.com/maps/search/?api=1&query=Sannes+Palace'; break;
            case 'DK Spot & Kota': url='https://www.google.com/maps/search/?api=1&query=DK+Spot+Kota'; break;
            case 'Nondyebo Eatery': url='https://www.google.com/maps/search/?api=1&query=Nondyebo+Eatery'; break;
            default: url='https://www.google.com/maps'; break;
        }
        window.open(url,'_blank');
    }

    window.onclick=function(event) {
        if (event.target==document.getElementById('menuModal')) closeModal();
        if (event.target==document.getElementById('foodModal')) closeFoodModal();
        if (event.target==document.getElementById('voucherModal')) closeVoucherModal();
    }

    function toggleFavorite(btn) {
        btn.innerText = (btn.innerText==='♥') ? '♡':'♥';
    }

    function openFoodModal(foodItem) {
        selectedFoodItem=foodItem;
        currentQuantity=1;
        document.getElementById('foodItemName').innerText=foodItem.name;
        document.getElementById('foodQuantity').innerText=currentQuantity;
        document.getElementById('foodModal').style.display='flex';
    }
    function closeFoodModal() { document.getElementById('foodModal').style.display='none'; }
    function changeQuantity(delta) {
        currentQuantity+=delta;
        if (currentQuantity<1) currentQuantity=1;
        document.getElementById('foodQuantity').innerText=currentQuantity;
    }
    function addItemToOrder() {
        if (selectedFoodItem) {
            orderItems.push({ name: selectedFoodItem.name, price: selectedFoodItem.price, quantity: currentQuantity });
            updateOrderSummary();
        }
        closeFoodModal();
    }

    function updateOrderSummary() {
        const ul=document.getElementById('orderItems');
        ul.innerHTML='';
        orderItems.forEach((item,index) => {
            const li=document.createElement('li');
            li.innerHTML=`${item.name} x${item.quantity} @ ${item.price} each`;
            const removeBtn=document.createElement('button');
            removeBtn.innerText='Remove';
            removeBtn.style.marginLeft='10px';
            removeBtn.onclick=()=>{ orderItems.splice(index,1); updateOrderSummary(); };
            li.appendChild(removeBtn);
            ul.appendChild(li);
        });
    }

    // Main checkout function
function goToCheckout() {
    if (orderItems.length===0) { alert("Your cart is empty!"); return; }

    document.getElementById('checkoutRestaurantTitle').innerText = currentRestaurant + ' - Checkout';

    const ul=document.getElementById('checkoutItems');
    ul.innerHTML='';

    let subtotal=0;
    orderItems.forEach(item => {
        const li=document.createElement('li');
        const priceNum=parseFloat(item.price.replace('R','').trim());
        const totalItemPrice=priceNum*item.quantity;
        subtotal+=totalItemPrice;
        li.innerHTML=`${item.name} x${item.quantity} @ ${item.price} each = R${totalItemPrice.toFixed(2)}`;
        ul.appendChild(li);
    });

    const vat=subtotal*0.15;
    let total=subtotal+vat+SERVICE_FEE+TIP+DELIVERY_FEE;

    if (appliedVoucher) {
        total -= discountAmount;
        if (total<0) total=0;
    }

    // Update display
    document.getElementById('subtotalDisplay').innerText=`R${subtotal.toFixed(2)}`;
    document.getElementById('vatDisplay').innerText=`R${vat.toFixed(2)}`;
    document.getElementById('serviceFeeDisplay').innerText=`R${SERVICE_FEE.toFixed(2)}`;
    document.getElementById('tipDisplay').innerText=`R${TIP.toFixed(2)}`;
    document.getElementById('deliveryFeeDisplay').innerText=`R${DELIVERY_FEE.toFixed(2)}`;
    document.getElementById('totalAmount').innerText=`R${total.toFixed(2)}`;
    document.getElementById('discountAmount').innerText=`R${discountAmount.toFixed(2)}`;

    document.getElementById('checkoutPage').style.display='block';
    document.querySelector('#orderSummary').style.display='none';
}

// Cancel checkout
function cancelCheckout() {
    document.getElementById('checkoutPage').style.display='none';
    document.querySelector('#orderSummary').style.display='block';
}

// Confirm payment
function confirmEFT() {
    // Recalculate total
    const ul=document.getElementById('checkoutItems');
    let subtotal=0;
    Array.from(ul.children).forEach(li => {
        const matches=li.innerText.match(/@ R([\d.]+)/);
        const qtyMatch=li.innerText.match(/x(\d+)/);
        if (matches && qtyMatch) {
            const price=parseFloat(matches[1]);
            const qty=parseInt(qtyMatch[1]);
            subtotal+=price*qty;
        }
    });
    const vat=subtotal*0.15;
    let total=subtotal+vat+SERVICE_FEE+TIP+DELIVERY_FEE;
    if (appliedVoucher) total -= discountAmount;
    if (total<0) total=0;

    alert(`Your payment of R${total.toFixed(2)} via EFT has been processed successfully. Thank you!`);
    orderItems=[]; updateOrderSummary();
    cancelCheckout();
}

// Voucher modal functions
function openVoucherModal() { document.getElementById('voucherModal').style.display='flex'; }
function closeVoucherModal() { document.getElementById('voucherModal').style.display='none'; }
function applyVoucher() {
    const code=document.getElementById('voucherInput').value.trim();
    if (code==='SAVE10') {
        discountAmount=10; alert('Voucher applied! R10 off.');
        appliedVoucher='SAVE10';
    } else if (code==='FREESHIP') {
        alert('Free delivery voucher applied! (simulated)');
        // Example: zero delivery fee in real scenario
    } else {
        alert('Invalid voucher code.');
        discountAmount=0; appliedVoucher=null;
    }
    closeVoucherModal();
}
</script>

</body>
</html>